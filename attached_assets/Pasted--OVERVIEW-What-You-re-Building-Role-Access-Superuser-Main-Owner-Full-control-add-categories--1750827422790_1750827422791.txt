âœ… OVERVIEW: What You're Building
Role	Access
ğŸ‘¤ Superuser (Main Owner)	Full control: add categories, assign supervisors, view reports, control branding
ğŸ§‘â€ğŸ­ Supervisor	Can register employees under allowed categories and mark their attendance via face
ğŸ‘¨â€ğŸ’¼ Employee	No login; their attendance is recorded via face only

ğŸ”§ TECHNOLOGY STACK
Part	Tool
Backend	Django (Python)
Face Matching	face_recognition, OpenCV, MediaPipe
Anti-Spoof	Eye blink detection with MediaPipe
Geo Location	Browser GPS (HTML5) + JavaScript
Reporting	pandas, reportlab / weasyprint, csv
Sync API	Django REST Framework
Frontend	Bootstrap + jQuery or HTMX
.NET Sync	Daily API call (cron job / celery beat)

ğŸ“ 1. DATABASE STRUCTURE
ğŸ”¹ Category & Job
python
Copy
Edit
class JobCategory(models.Model):
    name = models.CharField(max_length=100)
    created_by = models.ForeignKey(User, on_delete=models.CASCADE)  # Superuser

class JobTitle(models.Model):
    name = models.CharField(max_length=100)
    category = models.ForeignKey(JobCategory, on_delete=models.CASCADE)
ğŸ”¹ Supervisor & Employees
python
Copy
Edit
class Supervisor(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE)
    full_name = models.CharField(max_length=100)

class Employee(models.Model):
    employee_number = models.CharField(max_length=50, unique=True)
    name = models.CharField(max_length=100)
    job_title = models.ForeignKey(JobTitle, on_delete=models.SET_NULL, null=True)
    address = models.TextField()
    contact_number = models.CharField(max_length=20)
    email = models.EmailField(blank=True, null=True)
    supervisor = models.ForeignKey(Supervisor, on_delete=models.SET_NULL, null=True)
    face_encoding = models.BinaryField()  # store only encoding
ğŸ”¹ Attendance
python
Copy
Edit
class Attendance(models.Model):
    employee = models.ForeignKey(Employee, on_delete=models.CASCADE)
    date = models.DateField(auto_now_add=True)
    time = models.TimeField(auto_now_add=True)
    latitude = models.FloatField(null=True, blank=True)
    longitude = models.FloatField(null=True, blank=True)
    marked_by = models.ForeignKey(Supervisor, on_delete=models.SET_NULL, null=True)
ğŸ”„ 2. SYSTEM FLOW
ğŸ”¸ Employee Registration Flow (By Supervisor):
Supervisor selects job category & title.

Fills employee number, name, contact, etc.

Captures face once â†’ face encoding stored.

Assigned under that supervisor.

ğŸ”¸ Attendance Marking Flow:
Supervisor selects category â†’ sees their assigned employees.

Face camera opens â†’ live face compared with encoding.

Only on blink detection + face match, attendance is recorded.

Latitude & longitude auto-recorded (using JS navigator.geolocation).

No image is stored, only face encoding.

ğŸ§  3. Anti-Spoofing with Blink Detection
ğŸ›  How:
Use MediaPipe FaceMesh or dlib landmarks

Monitor eye aspect ratio (EAR)

Mark blink if eye closes and reopens quickly

If no blink in 5s â†’ block spoof attempt

âœ… Result: No photo or screen image can fake attendance.

ğŸ“Š 4. Reporting System (CSV/PDF)
Features:
Date-wise filter (range, weekly, monthly)

Filters by:

Supervisor

Job Category

Job Title

Export to:

CSV â†’ using pandas.to_csv()

PDF â†’ using weasyprint or reportlab

Superuser can access reports of all supervisors, supervisors can only see their own employees.

ğŸŒ 5. .NET API Integration
API Endpoints Django Will Provide:
GET /api/employees/ â†’ List of employees

GET /api/attendance/daily/ â†’ Attendance logs of the day

POST /api/sync-to-dotnet/ â†’ .NET system can fetch or receive attendance

âœ… Use django-rest-framework to expose endpoints
âœ… Use requests.post() to send JSON data daily at 11PM (via cron job or Celery)

ğŸ“ 6. Geo Location Auto-Capture
Use JS in template:

html
Copy
Edit
<script>
navigator.geolocation.getCurrentPosition(function(pos) {
    document.getElementById("lat").value = pos.coords.latitude;
    document.getElementById("lon").value = pos.coords.longitude;
});
</script>
Then pass that to Django before face capture.

âœ… Youâ€™ll store only coordinates. No map or GPS image needed.

ğŸ§¾ 7. Superuser Company Panel
Admin Settings Model:
python
Copy
Edit
class CompanyProfile(models.Model):
    name = models.CharField(max_length=200)
    logo = models.ImageField(upload_to='company/')
    about = models.TextField(blank=True)
Superuser can:

Update company name, logo

Control who can see which employees

Assign job categories to supervisors

ğŸ—‚ 8. File/Server Optimization
Only store one-time face encodings

No face images stored

Attendance entries are lightweight

All reports are generated only when requested

âœ… This makes the server light, fast, and privacy-compliant.

ğŸ” DAILY ATTENDANCE SYNC PLAN
At 10 PM each day:

Use cron or Celery to send todayâ€™s attendance to .NET via HTTP POST

You can format data as:

json
Copy
Edit
[
  {
    "employee_id": "EMP123",
    "name": "Ravi Kumar",
    "date": "2025-06-24",
    "time": "09:02 AM",
    "latitude": 26.8757,
    "longitude": 80.9112
  },
  ...
]
âœ… This can be fetched by .NET server or Django can push it.

âœ… FINAL MODULES TO BUILD
Module	Status
Supervisor Panel	âœ…
Employee Registration	âœ…
Category/Job Mgmt	âœ…
Attendance Camera + Anti-Spoof	âœ…
Geo-Location Capture	âœ…
Export Reports	âœ…
.NET Sync APIs	âœ…
Admin Branding Panel	âœ…